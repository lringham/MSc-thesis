\chapter{Case Study 2: Snakes}
\section{Biological background}
Snakes display many pigmentation patterns such as speckles, blotches, longitudinal stripes, and transverse stripes. Some of these pattern types are shown in Fig. \ref{fig:realSnakePatterns}. Snakes are entirely covered by protective scales whose top layer is made of translucent keratin. Under this layer is where pigmentation patterns are found. Although the keratin layer is translucent, it may contribute to the pattern's appearance by acting as prisms through which light refracts, producing an iridescent sheen. Scales contribute to pattern formation in other reptiles by limiting diffusion of pigments across the scale boundaries \citep{manukyan2017}.

Pigmentation patterns perform many useful functions, such as camouflaging the snake from prey and predators or acting as a brightly coloured warning signal that the snake may be venomous. An example warning pattern is seen on the North American coral snake, \textit{Micrurus fulvius}, with its distinctive red, yellow, and black coloured bands (Fig. \ref{fig:realSnakePatterns}a). Some non-venomous snakes employ mimicry, which serves as a defence mechanism by displaying a pattern similar to that of a venomous snake's. A well-known example of this is the scarlet king snake, \textit{Lampropeltis elapsoides}, which also displays red, black and yellow bands like \textit{M. fulvius} (Fig. \ref{fig:realSnakePatterns}b).

The regions of a snake that display pigmentation patterns can be roughly partitioned into the head, body, tail, and underbelly. Here I focus on the most striking patterns found on the body and tail. The similarity between patterns found in these regions and those found on the head or underbelly varies between species. It is not uncommon for the head and underbelly to display a different pattern than the body. A notable example is the ring-necked snake, shown in Fig. \ref{fig:realSnakePatterns}c, which presents a dull colour on its back, serving as camouflage. When the ring-necked snake is provoked, it will display its bright red and orange underside to deter predators.

\begin{figure}[hb]
	\centering
	\includegraphics[width=\columnwidth]{snakes.png}
	\caption{A collection of snakes with interesting patterns. \textbf{a:} An American coral snake, \textit{M. fulvius}. \textbf{b:} A scarlet kingsnake, \textit{L. elapsoides}. \textbf{c:} The tail of a ring-necked snake. \textbf{d:} A python. \textbf{e:} A corn snake. \textit{Photographs \textbf{a}: Peter Paplanus (CC BY-NC 2.0); \textbf{b}: courtesy of Trent Adamson; \textbf{c}: Glenn Bartolotti (CC BY-SA 3.0); \textbf{d,e}: courtesy of pixabay.com.}}
	\label{fig:realSnakePatterns}
\end{figure}

Snake patterns start development when the animal still in its egg. \citet{murakami2018} studied the early development of pigmentation patterns in the Japanese four-lined snake (\textit{Elaphe quadrivirgata}). The characteristic pattern \textit{E. quadrivirgata} displays is four black lateral lines on a light brown background (Fig. \ref{fig:Snake1}c). In juveniles, these stripes are dark brown and connected by transverse lines like a ladder. These transverse liens disappear in mature snakes.
 
To understand how the patterns of \textit{E. quadrivirgata} develop, snakes were observed at different points in time during embryonic development. Pigmentation is measured by observing chromatophore cells, which contain pigmentation molecules. A type of chromatophore, called a melanophore, is responsible for brown to black colouration and is first seen in deeper tissues of \textit{E. quadrivirgata} around 18-21 days after ovulation. These cells do not affect the later development of melanophores seen in the dermal and epidermal layers. Striped pigmentation patterns emerge behind the head after 26-32 days. Stripes then appear on the whole body, first thinly at 29-35 days and then clearly at 35-42 days. Data about how patterns emerge and develop are valuable because they contribute to an understanding of the patterning process and provide testable data points to guide the model's development.

\citet{allen2013} studied the role behaviour, and ecological factors played in snake pattern diversity by using reaction-diffusion. They classified these patterns by simulating reaction-diffusion with a custom-built program and having users compare the simulated patterns against real snake images. The match between a simulation and real snake image provided an association between the reaction-diffusion model and a real pattern. Pattern features such as size, complexity, and anisotropy were then represented as parameters.

To gain insight into how patterns are related the behaviour and environment of snakes, these parameters were associated with ecological and behavioural variables. Examples of ecological variables are those related to habitat like Desert or forest. Behavioural variables correspond to speed, aggression, and hunting strategy. Phylogenetic analysis then revealed to what extent the environment and or snake behaviour was responsible for the diversity of patterns. The results of this analysis suggested snake patterns are mainly correlated with behaviour rather than the environment the snakes inhabited. \citet{allen2013} found that plain longitudinally- striped snakes are usually smaller and prefer to flee from predators. The striped pattern makes the snake harder to track by sight while moving. Transverse striped and blotched snakes are often larger and more aggressive. They may also be more venomous and hunt by ambush.

\section{Previous modelling work}
Patterns on the ocellated lizard\footnote{Although lizards are of a different suborder than snakes, they both reside in the squamate reptile family because of their scaled bodies.} have been simulated by \citet{manukyan2017}. These lizards are covered in a quasi-hexagonal lattice of pigmented scales. A juvenile lizard's scales display white spots on a brown background. This pattern changes in adults whose scales are coloured individually, either a solid green or black. Pattern development continues over the lifetime of the adult, with scales switching between green and black. \citet{manukyan2017} modelled the adult pattern using a reaction-diffusion system on a grid where multiple cells represented one scale. They lowered the diffusion rates across the scale boundaries simulating thinner skin. Consequently, the diffusion between scales is much slower than inside an individual scale. This reaction-diffusion system behaves like a cellular automaton.

\citet{murray1991} modelled snake patterns by simulating the movement and interaction of chromatophores. Before chromatophores differentiate, they exist as chromatoblasts, which are found uniformly in the dermis. After some time, these cells may become chromatophores by producing pigments, resulting in a visible pattern. Movement of these cells is driven by diffusion and chemotaxis. The use of chemotaxis makes it possible to generate simple and more complex patterns when calculated on a growing domain. Although \citet{murray1991} proposed that standard reaction-diffusion models may also produce the same patterns. \citet{murray1991} produced more intricate patterns such as staggered and side-by-side spots as well as diamond-shaped patterns by growing the domain. Simulations are carried out on a grid, and only the patterns on the body of the snake are considered.

\citet{pinheiro2017} created a program for modelling snake patterns by using a combination of textures, cellular automata, and image manipulation. To simulate a transverse stripe pattern, a modeller can define up to four different coloured bands of various thicknesses can be combined. Similarly, for longitudinal stripes, the modeller defines the number and colour of the stripes can be customized. To simulate spots, circle textures are randomly distorted in size and position. For other simple patterns, cellular automata are used to generate blotch or zigzag patterns. Generated patterns are unnaturally uniform, so they are distorted using Perlin noise to look more organic. This results in a generated texture that is rendered on a snake mesh and enhanced by using a roughness and height map to provide a scaly appearance. This approach produces compelling results, although \citet{pinheiro2017} notes that more complex patterns need a phenomenon such as chemotaxis, which involves simulating chemicals moving up concentration gradients.

\section{Model description}
I have produced snake patterns using reaction-diffusion on a mesh representing the snake's skin. Most of my models use different parameters for the ventral scales, as there often is a different pattern found there. Snake meshes have been modelled and rendered using the 3D computer graphics software Blender. A normal map is used to add a scaly appearance, and two black spheres are used to represent snake eyes. Models A-E use Gray-Scott reaction-diffusion equations, Eqn. \ref{eq:grayscottRD}, and the parameter values are found in Table \ref{tab:gsSnakeParameters}. Model F uses the activator-depleted substrate model with saturation, Eqn. \ref{eq:ladybugRD}, and its parameters are found in Table \ref{tab:snakeParameters}. Models B, D, and F assume anisotropic diffusion. The vector field used runs parallel to the snake's longitudinal axis. The coefficient $\lambda_{1}$ is the diffusivity in the direction of the vector field, and $\lambda_{2}$ is the diffusivity orthogonal to it (Eq. \ref{eq:diffTensor}). 

\newpage
% first model
The first snake model displays brightly coloured transverse stripes like those of the Honduran milk snake (\textit{Lampropeltis triangulum hondurensis}). This species is non-venomous but appears similar to other venomous snakes. The initial distribution of morphogens and the final pattern are shown in Fig. \ref{fig:Snake1}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{Snake1.png}
	\caption{Model of the Honduran milk snake. The activator, $a$, is visualized where concentration values from low to high are represented as dark orange, black, and bright orange. \textbf{a:} The initial state: $a=1$ on the nose and $0$ elsewhere, $s=1$ everywhere. \textbf{b:} The final pattern. \textbf{c:} An image of a real Honduran milk snake. \textit{Photograph: courtesy of Douglas Mong}}
	\label{fig:Snake1}
\end{figure}

% second model
The next snake model displays a pattern consisting of four black lateral stripes, similar to those of an adult \textit{E. quadrivirgata}. I have assumed anisotropic diffusion of the activator $a$, as described in Eqn. \ref{eq:ficks2ndlaw0}, of $a$. The vector field used by $a$ runs parallel to the snake's longitudinal axis. The diffusivity coefficients are $\lambda_{1}=1$ and $\lambda_{2}=0.502$. Anisotropic diffusion with $\lambda_{1} > \lambda_{2}$ was important because the lines should form parallel to the longitudinal axis of the snake. The ventral scale's parameters vary from those used on the dorsal side by setting $f=0$ so that extra lines do not form on the underside. The initial and final patterns are shown in Fig. \ref{fig:Snake2}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{Snake2.png}
	\caption{Model of the \textit{E. quadrivirgata}. The activator, $a$, is visualized where concentration values from low to high are represented as brown to black. \textbf{a:} The initial morphogen distribution is $s=1$ and $a=0$ except a stripe of $a=1$ down the dorsal side of the snake. \textbf{b:} The final pattern. \textbf{c:} An image of a real \textit{E. quadrivirgata}. \textit{Photograph: courtesy of Anthony von Plettenberg Laing}}
	\label{fig:Snake2}
\end{figure}

\newpage
% third model - 11028.041 to 44303.008 area
The third model I made displays a spot or blotch pattern like that of the spotted rock snake (\textit{Lamprophis guttatus}). %TODO why was this interesting
The model includes growth and adaptive subdivision. There are two phases to pattern formation. In phase 1, the simulation is initialized from a random placement of morphogens. After initialization, a row of spots forms on the snake. Phase 1 lasts for 100,000 iterations, after which phase 2 begins. The snake is grown uniformly over 70,000 iterations increasing its surface area by four times. Faces of the mesh start with an average area of $0.52$ and are subdivided when they exceed the max face area of $1$. This growth allows the spot pattern to form into two rows of spots. Fig. \ref{fig:Snake3} shows this model.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{Snake3.png}
	\caption{Model of the spotted rock snake. \textbf{a:} Start of phase 1 showing the initial morphogen distribution of $s=1$ and $a=0$ except for 30 randomly placed spots where $a=1$. \textbf{b:} A pattern of spots has formed along the snake. This is the end of phase 1 and the start of phase 2. \textbf{c:} End of phase 2 where rows of spots have formed on an enlarged snake. \textbf{d:} An image of a real spotted rock snake. \textit{Photograph: courtesy of Tyrone Ping}}
	\label{fig:Snake3}
\end{figure}

\newpage
%Fourth model
The common European viper, \textit{Vipera berus}, displays an interesting zigzag pattern. This snake is venomous, and the pattern can serve as a warning signal or as camouflage when the snake is tightly coiled \citep{lillywhite2014}. Morphogen $a$ diffuses anisotropically using coefficients $\lambda_{1}=0.81$, $\lambda_{2}=1$. This model is shown in Fig. \ref{fig:Snake4}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{Snake4.png}
	\caption{Model of the European viper. \textbf{a:} The initial distribution of $a$ is randomly chosen from $[.5, 1)$ for each vertex and $s=1$ everywhere. The concentration of $a$ seen is multiplied by $0.263$ to show the character of the start state pattern. The colour map expects values in the range $[0-1]$. \textbf{b:} The final pattern. In this case $a$ multiplied by $0.556$. \textbf{c:} An image of a real \textit{V. berus}. \textit{Photograph: Benny Trapp (CC BY 3.0)}}
	\label{fig:Snake4}
\end{figure}

\newpage
%Fifth model
Another snake model is based on the transverse stripes of a southern coral snake (\textit{Micrurus frontalis}). The stripes are brightly coloured and are a warning to others that this snake contains a potent venom. There are two phases: pattern establishment and mesh growth. The mesh grows uniformly over $23,000$ iterations causing the snake's surface area to double. Mesh faces start with an average area of $0.55$ and the faces are subdivided when they exceed an area of $1$. The snake mesh used is shown in Fig. \ref{fig:Snake5}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{Snake5.png}
	\caption{Model of the \textit{M. frontalis}. \textbf{a:} Initially $s=1$ and $a=0$ everywhere except on the nose, where $a=1$. $a$ is visualized from red to black to white and is normalized by $0.520$. \textbf{b:} end of phase 1 where a basic stripe pattern has formed. \textbf{c:} The final pattern after growth. Black stripes have appeared in-between the previous stripes. \textbf{d:} A picture of a real \textit{M. frontalis}. \textit{Photograph: William Quatman (CC BY-SA 2.0)}}
	\label{fig:Snake5}
\end{figure}

\newpage 

The California kingsnake (\textit{Lampropeltis californiae}) contains white and black transverse stripes, which sometimes bifurcate. I have assumed anisotropic diffusion on the snake's body. Morphogen $u$ assumes diffusivity coefficients $\lambda_{1}=0.75$, $\lambda_{2}=1$, and $v$ assumes $\lambda_{1}=1$, $\lambda_{2}=0.75$. Anisotropy was needed to align the stripes perpendicular to the body strongly. The snake's head assumes standard isotropic diffusion as the real snake does not have stripes on its head. This model is shown in Fig. \ref{fig:Snake6}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{Snake6.png}
	\caption{Model of the \textit{L. californiae}. Morphogen $u$ is visualized as white when its value is low and black when high. \textbf{a:} The initial distribution is $u=0$ and $v=1$ everywhere except a lateral stripe  of $u=1$. \textbf{b:} The final pattern. \textbf{c:} An image of a real \textit{L. californiae}. \textit{Photograph: courtesy of David Steen}}
	\label{fig:Snake6}
\end{figure}

\newpage

\section{Discussion}
Snake patterns provide an interesting modelling challenge due to the broad diversity of patterns on a geometrically simple domain. I have produced a variety of patterns based on real snake species. By using the features of \ProgramName{}, such as the simulation of growth and anisotropic diffusion, I generated relatively complex pigmentation patterns. My previous models of ladybugs and research into the parameter space of the Gray-Scott model (Eqn. \ref{eq:grayscottRD}) helped me identify iconic features of reaction-diffusion patterns that were also seen on snakes. Most of the models produced the same type of pattern on a straight and curved domain. However, simulating model E on a curved domain caused the stripes to split, creating an incorrect forked pattern. Likewise, simulating model F on a straight domain did not allow the stripes to fork correctly. This behaviour begs the question as to what pose a snake assumes throughout its pattern's development. As stated by \citet{murray1991}, reaction-diffusion without the effect of chemotaxis is expressive enough to produce some snake patterns. As illustrated in Fig. \ref{fig:SnakeRendering}, reaction-diffusion models can be used to create convincing biological patterns for use in computer graphics. Future work may provide an understanding of the role of scales in pattern formation. Models that account for the effect of scale boundaries on diffusion may produce the more delicate details seen in nature, such as the pigmented tips of scales. 

One noticeable limitation of the models is seen on the ends of the tails. Stationary reaction-diffusion patterns are frequently standing waves with a fixed wavelength. Thus, the patterns can only fit on a domain if there is enough space for them. A  fixed wavelength poses a problem because the end of the tail runs out of space to support the same pattern seen on the body. In nature, the patterns tend to scale down to account for the tail tapering. However, gradually reducing the diffusion rate based on the proximity to the end of the tail might be a solution.

Snake pattern formation is of great interest to herpetologists, who study reptiles and amphibians. They can understand snake evolution through the myriad of patterns snakes display. Snake breeders profit off selling snakes that display striking and unique patterns. Consequently, there is also a financial incentive to predict the effect of breeding on pattern development.


% snake on ground with some iridescence
\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{ground_1.png}
	\caption{A rendering of \textit{E. quadrivirgata} with iridescence.}
	\label{fig:SnakeRendering}
\end{figure}

\begin{table}[ht]
	\centering
	\resizebox{\columnwidth}{!}{
	\begin{tabular}{llllllll}
	\hline
	\textbf{Model} & \textbf{Species} &\bm{$D_a$} &\bm{$D_s$} &\bm{$f$}    &\bm{$k$}   &\bm{$dt$} & \thead{\textbf{Total steps} \\ \textbf{(x1000)}}\\ \hline 
	A     &\textit{L. triangulum hondurensis} &1.000 &2.000 &0.026 &0.055 &0.030 &200 \\ 
	B     &\textit{E. quadrivirgata} &0.175 &0.350 &0.078 &0.061 &0.030 &28 \\ 
	C     &\textit{L. guttatus} &0.350 &0.700 &0.022 &0.022 &0.100 &100; 70 \\ 
	D     &\textit{V. berus} &0.150 &0.300 &0.109 &0.053 &0.300 &40 \\ 
	E     &\textit{M. frontalis} &1.000 &2.000 &0.034 &0.057 &0.030 &200; 23 \\ 
	\hline \end{tabular}
	}
	\caption {Parameters for models A-E using the Gray-Scott equations (Eqn. \ref{eq:grayscottRD}). In B and C the ventral scales have $f=0$. In D the ventral scales have $f=0$ and $k=0.08$. In the \Quotes{Total steps (x1000)} column, values separated by a semicolon denote a multi-phase model with the first and second values representing phase 1 and 2 respectively.}
	\label{tab:gsSnakeParameters}
\end{table}

\begin{table}[ht]
	\centering
	\resizebox{\columnwidth}{!}{
	\begin{tabular}{llllllllllll}
	\hline
	\textbf{Model} & \textbf{Species} & \bm{$D_u$} &\bm{$D_v$} &\bm{$\kappa$} &\bm{$\rho_u$} &\bm{$\rho_v$} &$\bm{\sigma_u$} &\bm{$\sigma_v$} &\bm{$\mu_u$} &\bm{$dt$} &\thead{\textbf{Total steps} \\ \textbf{(x1000)}}\\ \hline 
	F     &\textit{L. californiae} &0.056 &3.36 &0.5 &0.18 &0.36 &0.001 &0.1 &0.08 &0.01 &70                \\ \hline
	\end{tabular}
	}
	\caption {Parameter values for the California kingsnake model. This model uses the activator-depleted substrate equations (Eqn. \ref{eq:grayscottRD}).}
	\label{tab:snakeParameters}
\end{table}
