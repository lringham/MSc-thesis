\chapter{Case Study 2: Snakes}
\section{Literature Review}
Snakes are long legless reptiles that display many pigmentation patterns such as speckles, blotches, and longitudinal and transverse stripes, some of which are shown in Fig \ref{fig:realSnakePatterns}. The snake is entirely covered in scales. The top of which is made of translucent keratin. Under this top layer is where pigmentation patterns are found. Although the keratin is translucent, it may contribute to the pattern's appearance by acting as prisms through which light refracts, producing an iridescent sheen. Scales may also limit diffusion of pigments across the scale boundary as seen in the ocellated lizard \citep{manukyan2017}.

Pigmentation patterns perform many useful functions, such as hiding the snake from prey and helping the snake itself avoid becoming prey. These functions are fulfilled by camouflaging the snake from potential predators or acting as a brightly coloured warning signal that the snake may be venomous. An example warning pattern is seen on the north American coral snake, \textit{Micrurus fulvius}, with its distinctive red, yellow, and black coloured bands \hl{cite}. Some non-venomous snakes employ mimicry as a defence mechanism by displaying a pattern like a venomous snake’s. A well-known example of this is the scarlet king snake, \hl{Lampropeltis elapsoides}, who also displays red, black and yellow bands like \textit{M. fulvius}, shown in Fig \ref{fig:realSnakePatterns}.

The regions of a snake that display pigmentation patterns can be roughly partitioned as the head, body, tail, and underbelly \hl{cite?}. The main patterns of interest in this work occur on the body and tail, which are often indistinguishable. The similarity between patterns found on these regions and those found on the head or underbelly vary between species. It is not uncommon for the head or underbelly to display a different pattern than each other or what is seen on the body. This may be due to the difference in scale shape between regions as well as the visibility and importance of these regions \hl{ref}. A notable example is the ring-necked Snake which presents a plain brown color on its back which serves as camouflage. When the ring-necked snake is provoked, it will display its bright red and orange underside to deter predators.

\begin{figure}[hb]
	\centering
	\includegraphics[width=\columnwidth]{snakes.png}
	\caption{A collection of snakes with interesting patterns. \textbf{top-left:} The tail of a ring-necked snake. Photograph by Peter Paplanus licensed under CC BY-NC 2.0. \textbf{top-middle:} A Scarlet King Snake. Photograph by Andrew DuBois licensed under CC BY 2.0. \textbf{top-right:} A Sonoran Coral Snake. Photograph by David Jahn licensed under CC BY-SA 2.0. \textbf{bottom-left:} A python. \textbf{bottom-right:} A cornsnake. Photographs from Pixabay under CC0.}
	\label{fig:realSnakePatterns}
\end{figure}

Patterns on the ocellated lizard have been simulated by \citep{manukyan2017}. These lizards are covered in a quasi-hexagonal lattice of pigmented scales. As a juvenile, the lizard's scales display white spots on a brown background. This pattern changes in adults, whose scales are coloured individually either a solid green or black. These scales also switch between colours over the lifetime of the lizard. By studying pattern formation on ocellated lizards over three to four years, it was found that the colouration of each scale can be modelled by a reaction-diffusion system with diffusion varying across the scale boundaries. Consequently, the diffusion between scales is much slower than inside an individual scale. This results in scales acting as cells in a discrete reaction-diffusion model. Remarkably, this reaction-diffusion system behaves as a cellular automaton when the diffusion between scales is low enough.

Many natural patterns are seen in their final stable state or at a single point during their development. Observations of development over time are often difficult to observe because pattern formation occurs slowly or during a time when the animal is very young. The development of pigmentation patterns has been studied in Japanese four-lined snakes (\textit{Elaphe quadrivirgata}) \citep{murakami2018}. The characteristic pattern \textit{E. quadrivirgata} displays is light brown background color with four black lateral lines. In juveniles, these stripes are dark brown and connected like a ladder. At different points in time during embryonic development, these snakes were measured to gain an understanding of their physical and colouration changes.
 
Pigmentation is measured by observing chromatophore cells, which contain pigmentation molecules. A type of chromatophore, called a melanophore is responsible for brown to black colouration and are first seen in deeper tissues of \textit{E. quadrivirgata} around 18-21 days. But it is stated that these cells did not affect the later development of melanophores seen in the dermal and epidermal layers. Striped pigmentation patterns were first seen to emerge behind the head after 26-32 days. This pattern then appears on the whole body, first thinly at 29-35 days and then clearly at 40-42 days. This pattern development continues after the snake has hatched. These observations are valuable because they give insight into the required initial conditions of a reaction-diffusion simulation.

\citet{pinheiro2017} created snake patterns by using a combination of textures, cellular automaton, and image manipulation to generate texture for triangular meshes. To simulate a transverse stripe pattern, users can define up to four different coloured bands of various thickness. Similarly, for longitudinal stripes, the user defines the number and colour of the stripes which are then blended together with a background colour. To simulate spots, the user can choose from a selection of randomly distorted circles. For other simple patterns, cellular automaton are used to generate blotch or zigzag patterns. The patterns generated are very uniform, so they are distorted using Perlin noise. This results in a generated texture which is rendered on a snake mesh. They enhanced these patterns by using a roughness and height map to give the snake model scales. This approach produces very convincing results, although they note that more complex patterns need an approach such as chemotaxis, which involved simulating PDEs with chemicals removing up concentration gradients.

Snake pattern diversity has been studied by using reaction-diffusion as a method to quantify snake patterns \citep{Allen2013}. This quantification was achieved by having users compare snake-like reaction-diffusion patterns, simulated on a grid, against real snake images. This provided an association between a reaction-diffusion model and a real image resulting in a parameter representation of the real snake’s pattern. These parameters represent visual features such as pattern size, complexity, and anisotropy. Also, snake pattern evolution is then represented by changes in parameter values. To gain insight into how patterns are related to snake behaviour and their environment, these parameters are associated with ecological and behavioural variables. Phylogenetic analysis then reveals to what extent the environment and or  snake behaviour is responsible for the diversity of patterns. The results of this analysis suggested that snake patterns are mainly driven by behaviour rather than the environment the snakes inhabited. \hl{Talk more about snake behaviour and patterning. Include reference and or more info from snake book - How Snakes Work Structure, Function and Behavior of the World's Snakes}

A biologically motivated model of snake patterns has been studied by \citep{MURRAY1991} where they model the movement and interaction of chromatophores. Before chromatophores differentiate, they exist as chromatoblasts, which are found uniformly in the dermis. After some time these cells may become chromatophores by producing pigments, resulting in a visible pattern. The phenomenon of cell movement towards higher density is called chemotaxis. Although it is unclear when and where this effect is present in real snakes, its use affords the creation of simple and more advanced patterns when calculated on a growing domain. Although it is admitted that standard reaction-diffusion models may also produce the same patterns.

The chemotaxis-cell model contains one morphogen, $n$, representing the concentration of chromatophores. These chromatophores diffuse and reproduce by mitosis. The chromatophores produce a second morphogen, $c$, known as a chemoattractant which diffuses and decays. Chromatophores undergo reverse difusion towards higher concentrations of chemoattractant. This  causes patterns to sharpen. Mathematically this model is:

\begin{equation}
\begin{aligned} \label{eq:chemotaxis}
  \frac{\partial n}{\partial t} &= D \Lap{} n - \alpha \Div{} (n\Grad{}c) + srn(N-n), \\
  \frac{\partial c}{\partial t} &= \Lap{} c + s(\frac{n}{1+n}-c).
\end{aligned}
\end{equation}

Using this model they are able to produce transverse and lateral stripes. By growing the domain they can produce more intricate patterns such as staggered and side-by-side spots as well as diamond shaped patterns. These simulations are carried out on a grid, and again only the patterns on the body of the snake are considered.

\section{Model Description}
\hl{need models with growth, to highlight and justify the program feature}

One model forms stripes and then grows to produce double stripes as seen in the copperhead.

\section{Results}

\section{Discussion}
I have produced a variety of different snake patterns on meshes. By using the features of \ProgramName{} like growth and anisotropy more complex patterns were also generated. 

Some future work can be made by understanding the role of scale thickness and shape on pattern formation. Incorporating this into a discrete model would allow for modelling of patterns seen on the snake head and ventral scales. 