\chapter{Case Study 2: Snakes}

\section{Biological background}
Snakes display many pigmentation patterns such as speckles, blotches, longitudinal stripes, and transverse stripes. Some of these pattern types are shown in Fig. \ref{fig:realSnakePatterns}. Snakes are entirely covered in protective scales whose top layer is made of translucent keratin. Under this layer is where pigmentation patterns are found. Although the keratin is translucent, it may contribute to the pattern's appearance by acting as prisms through which light refracts, producing an iridescent sheen. Scales contribute to pattern formation in other reptiles by limiting diffusion of pigments across the scale boundaries \citep{manukyan2017}.

Pigmentation patterns perform many useful functions, such as camouflaging the snake from prey and predators or acting as a brightly coloured warning signal that the snake may be venomous. An example warning pattern is seen on the North American coral snake, \textit{Micrurus fulvius}, with its distinctive red, yellow, and black coloured bands. Some non-venomous snakes employ mimicry which serves as a defence mechanism by displaying a pattern like a venomous snake's. A well-known example of this is the scarlet king snake, \textit{Lampropeltis elapsoides}, which also displays red, black and yellow bands like \textit{M. fulvius}, both of which are shown in Fig. \ref{fig:realSnakePatterns}b-c.

The regions of a snake that display pigmentation patterns can be roughly partitioned as the head, body, tail, and underbelly. The main patterns of interest in this work occur on the body and tail. The similarity between patterns found on these regions and those found on the head or underbelly vary between species. It is not uncommon for the head and underbelly to display a different pattern than the body. A notable example is the ring-necked snake, shown in Fig. \ref{fig:realSnakePatterns}a, which presents a plain color on its back, serving as camouflage. When the ring-necked snake is provoked, it will display its bright red and orange underside to deter predators.

\begin{figure}[hb]
	\centering
	\includegraphics[width=\columnwidth]{snakes.png}
	\caption{A collection of snakes with interesting patterns. \textbf{a:} The tail of a ring-necked snake. \textbf{b:} A scarlet kingsnake, \textit{L. elapsoides}. \textbf{c:} An American coral snake, \textit{M. fulvius}. \textbf{d:} A python. \textbf{e:} A corn snake. \textcolor{citation-gray}{Photographs \textbf{a}: Peter Paplanus (CC BY-NC 2.0); \textbf{b}: courtesy of Trent Adamson; \textbf{c}: Glenn Bartolotti (CC BY-SA 3.0); \textbf{d,e}: courtesy of pixabay.com.}}
	\label{fig:realSnakePatterns}
\end{figure}

Snake patterns start development when the animal still in its egg, but the patterns are often only observed if the snake is easily visible. \citet{murakami2018} studied the early development of pigmentation patterns in the Japanese four-lined snake (\textit{Elaphe quadrivirgata}). The characteristic pattern \textit{E. quadrivirgata} displays is four black lateral lines on a light brown background. In juveniles, these stripes are dark brown and connected by transverse lines like a ladder. 
 
To understand how these patterns develop, snakes were measured at different points in time during embryonic development. Pigmentation is measured by observing chromatophore cells, which contain pigmentation molecules. A type of chromatophore, called a melanophore, is responsible for brown to black colouration and is first seen in deeper tissues of \textit{E. quadrivirgata} around 18-21 days after ovulation. These cells do not affect the later development of melanophores seen in the dermal and epidermal layers. Striped pigmentation patterns were first seen to emerge behind the head after 26-32 days. Stripes then appear on the whole body, first thinly at 29-35 days and then clearly at 35-42 days. Data about how patterns start are valuable because they give insight into the required initial conditions of a reaction-diffusion simulation.

\section{Literature Review}
Snake pattern diversity has been studied by using reaction-diffusion as a method to classify snake patterns \citep{Allen2013}. Classification was achieved by having users compare snake-like reaction-diffusion patterns, simulated on a grid, against real snake images. This provided an association between a reaction-diffusion model and a real image. Resulting in a parameter representation of the real snakeâ€™s pattern where parameters represent visual features such as pattern size, complexity, and anisotropy. In this model, snake pattern evolution is represented by changes in parameter values. To gain insight into how patterns are related to snake behaviour and their environment, these parameters are associated with ecological and behavioural variables. Phylogenetic analysis then reveals to what extent the environment and or  snake behaviour is responsible for the diversity of patterns. The results of this analysis suggested that snake patterns are mainly driven by behaviour rather than the environment the snakes inhabited. \citet{Allen2013} found that plain longitudinally striped snakes are usually smaller and prefer to flee from predators. The striped pattern makes the snake harder to track by sight while moving. Transverse striped and blotched snakes are often larger and more aggressive. They may also be more venomous and hunt by ambush.

Patterns on the ocellated lizard\footnote{Although lizards are of a different suborder than snakes, they both reside in the squamate reptile family because of their scaled bodies.} have been simulated by \citet{manukyan2017}. These lizards are covered in a quasi-hexagonal lattice of pigmented scales. A juvenile lizard's scales display white spots on a brown background. This pattern changes in adults, whose scales are coloured individually either a solid green or black. Pattern development continues over the lifetime of the adult with scales switching between green and black. \citet{manukyan2017} modelled this adult pattern using a reaction-diffusion system with diffusion rates varying across the scale boundaries. Consequently, the diffusion between scales is much slower than inside an individual scale. Remarkably, this reaction-diffusion system behaves as a cellular automaton.

\citet{pinheiro2017} created a program with which users can model snake pattern textures by using a combination of textures, cellular automata, and image manipulation. To simulate a transverse stripe pattern, users can define up to four different coloured bands of various thickness. Similarly, for longitudinal stripes, the user defines the number and colour of the stripes which are combined with a background colour. To simulate spots, circle textures are randomly distorted in size and position. For other simple patterns, cellular automata are used to generate blotch or zigzag patterns. The generated patterns are unnaturally uniform, so they are distorted using Perlin noise to look more organic. This results in a generated texture which is rendered on a snake mesh and enhanced by using a roughness and height map to provide a scaly appearance. This approach produces very convincing results, although \citet{pinheiro2017} note that more complex patterns need a phenomenon such as chemotaxis, which involves simulating PDEs with chemicals moving up concentration gradients.

\citet{MURRAY1991} modelled snake patterns by simulating the movement and interaction of chromatophores. Before chromatophores differentiate, they exist as chromatoblasts, which are found uniformly in the dermis. After some time, these cells may become chromatophores by producing pigments, resulting in a visible pattern. Movement of these cells is driven by diffusion and chemotaxis. Although it is unclear when and where chemotaxis is present in real snakes, its use affords the creation of simple and more advanced patterns when calculated on a growing domain. It is proposed that standard reaction-diffusion models may also produce the same patterns.

The chemotaxis-cell model contains a morphogen representing the concentration of chromatophores and a second morphogen known as a chemoattractant. Chromatophores produce chemoattractant and undergo chemotaxis towards higher concentrations of it. A behaviour that causes patterns to sharpen based on the attraction strength. \citet{MURRAY1991} produced more intricate patterns such as staggered and side-by-side spots as well as diamond shaped patterns by growing the domain. Simulations are carried out on a grid and only the patterns on the body of the snake are considered.

\section{Model Description}
I have produced snake patterns using reaction-diffusion on a triangular mesh. Most of my models use different parameters for the ventral scales as there are often a different or no pattern found there. Snake models have been rendered using the 3D computer graphics software Blender. A normal map is used to add a scaly appearance to the triangular mesh, and two black spheres are used to represent snake eyes. Models A-E use Gray-Scott reaction-diffusion equations, Eqn. \ref{eq:grayscottRD}, and the parameter values are found in Table \ref{tab:gsSnakeParameters}. Model F uses the activator-depleted substrate model with saturation, Eqn. \ref{eq:ladybugRD}, and its parameters are found in Table \ref{tab:snakeParameters}.

\newpage
% first model
The first snake model displays brightly coloured transverse stripes like that of the Honduran milk snake (\textit{Lampropeltis triangulum hondurensis}). This species is non-venomous but appears similar to other venomous snakes. The initial distribution of morphogens and final pattern are shown in Fig. \ref{fig:Snake1}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{Snake1.png}
	\caption{Model of the Honduran milk snake. The morphogen $a$ is visualized where concentration values from low to high are coloured dark orange, black, and bright orange. \textbf{a:} $a$ is set to $1$ on the nose and $0$ elsewhere and $s=1$ everywhere. \textbf{b:} The final pattern. \textbf{c:} An image of a real Honduran milk snake. \textcolor{citation-gray}{Photograph: courtesy of Douglas Mong}}
	\label{fig:Snake1}
\end{figure}

% second model
The next snake model displays a pattern consisting of four black lateral stripes, like that of an adult \textit{E. quadrivirgata}. I have used anisotropic diffusion, as described in Eqn. \ref{eq:anisoLap}, of $a$. The diffusivity coefficients are $\lambda_{1}=0.502$, $\lambda_{2}=1$. The vector field used by $a$ is pre-computed with another simulation consisting of only diffusion of a single morphogen. A source was defined at a vertex on the tip of the nose and the normalized gradient of the resulting morphogen distribution was saved for use as a vector field. The ventral scale's parameters vary from those used on the dorsal side so that extra lines do not form on the underside. Initial pattern state and the final pattern are shown in Fig. \ref{fig:Snake2}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{Snake2.png}
	\caption{Model of the \textit{E. quadrivirgata}. The morphogen $a$ is visualized with low concentration values are coloured brown and high values are black. \textbf{a:} The initial morphogen distribution is $s=1$ and $a=0$ except a stripe of $a=1$ down the dorsal side of the snake. \textbf{b:} The final pattern. \textbf{c:} An image of a real \textit{E. quadrivirgata}. \textcolor{citation-gray}{Photograph: courtesy of Anthony von Plettenberg Laing}}
	\label{fig:Snake2}
\end{figure}

\newpage
% third model - 11028.041 to 44303.008 area
The third model I made displays a spot or blotch pattern like that of the spotted rock snake (\textit{Lamprophis guttatus}). Blotch patterned snakes respond to predators by fleeing a short distance and then freezing in place, which can cause the snake to appear as if they vanished \citep{lillywhite2014}. 
My model includes growth and adaptive subdivision. There are two phases to pattern formation. In phase 1, a row of spots form on the snake from a random placement of morphogens. After 100,000 iterations these spots are established and phase 2 begins. The snake is grown uniformly by $0.002\%$ in each axis every 200 iterations and faces of the mesh are subdivided when they exceed the max face area of 1. The surface area of the snake increases by a factor of 4, allowing for the spot pattern to form into two rows of spots. Find this model in Fig. \ref{fig:Snake3}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{Snake3.png}
	\caption{Model of the spotted rock snake. \textbf{a:} Start of phase 1 showing the initial morphogen distribution of $s=1$ and $a=0$ except for 30 randomly placed spots of radius 2 where $a=1$. \textbf{b:} A pattern of spots has formed along the snake. This is the end of phase 1 and the start of phase 2. \textbf{c:} End of phase 2 where rows of spots have formed on an enlarged snake. \textbf{d:} An image of a real spotted rock snake. \textcolor{citation-gray}{Photograph: courtesy of Tyrone Ping}}
	\label{fig:Snake3}
\end{figure}

\newpage
%Fourth model
The common European viper, \textit{Vipera berus}, displays an interesting zig-zag pattern. This snake is venomous, and the pattern can serve as a warning signal or as camouflage when the snake is tightly coiled \citep{lillywhite2014}. Morphogen $a$ diffuses anisotropically using coefficients $\lambda_{1}=0.81$, $\lambda_{2}=1$. This model is shown in Fig. \ref{fig:Snake4}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{Snake4.png}
	\caption{Model of the European viper. \textbf{a:} The initial distribution of $a$ is randomly chosen from $[.5, 1)$ for each vertex and $s=1$ everywhere. The concentration of $a$ is seen normalized by 3.8 to show the character of the start state pattern. \textbf{b:} The final pattern. In this case $a$ normalized by $1.8$. \textbf{c:} An image of a real \textit{V. berus}. \textcolor{citation-gray}{Photograph: Benny Trapp (CC BY 3.0)}}
	\label{fig:Snake4}
\end{figure}

\newpage
%Fifth model
Another snake model is based on the transverse stripes of a southern coral snake (\textit{Micrurus frontalis}). The stripes are brightly coloured and are a warning to others that this snake contains a potent venom. There are two phases: pattern establishment and mesh growth. The mesh grows by $0.0015\%$ in each axis every $100$ iterations and the max face area is $1$. The causes the snakes surface area to double. The snake mesh used is shown in Fig. \ref{fig:Snake5}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{Snake5.png}
	\caption{Model of the \textit{M. frontalis}. \textbf{a:} Initially $s=1$ and $a=0$ everywhere except on the nose, where $a=1$. $a$ is visualized from red to black to white and is normalized by $0.520$. \textbf{b:} end of phase 1 where a basic stripe pattern has formed. \textbf{c:} The final pattern after growth. Black stripes have appeared in-between the previous stripes. \textbf{d:} A picture of a real \textit{M. frontalis}. \textcolor{citation-gray}{Photograph: William Quatman (CC BY-SA 2.0)}}
	\label{fig:Snake5}
\end{figure}

\newpage 

The California kingsnake (\textit{Lampropeltis californiae}) contains white and black transverse stripes which sometimes bifurcate. On the snake body, the morphogen $u$ uses  anisotropic diffusion with coefficients $\lambda_{1}=0.75$, $\lambda_{2}=1$ and $v$ uses $\lambda_{1}=1$, $\lambda_{2}=0.75$. The head uses isotropic diffusion as the real snake does not have stripes on its head. This model is shown in Fig. \ref{fig:Snake6}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{Snake6.png}
	\caption{Model of the \textit{L. californiae}. Morphogen $u$ is visualized as white when its value is low and black when high. \textbf{a:} The initial distribution is $u=0$ and $v=1$ everywhere except a lateral stripe  of $u=1$. \textbf{b:} The final pattern. \textbf{c:} An image of a real \textit{L. californiae}. \textcolor{citation-gray}{Photograph: courtesy of David Steen}}
	\label{fig:Snake6}
\end{figure}

\newpage

\section{Discussion}
Snake pattern formation is of great interest to herpetologists, who study reptiles and amphibians. They can understand snake evolution through the myriad of patterns snakes display. Others such as snake breeders profit off selling snakes that display striking and unique patterns. Consequently, there is also a financial incentive to predict the effect of breeding on pattern development. 

Snake patterns provide an interesting modelling challenge. I have produced a variety of patterns based on real snake species and by using the features of \ProgramName{} such as growth and anisotropy I generated more complex pigmentation patterns. As illustrated in Fig. \ref{fig:SnakeRendering}, reaction-diffusion models can be used to create convincing biological patterns for use in computer graphics. Future work may provide an understanding of scale thickness and shape and its effect on pattern formation. More biologically accurate models of growth and pigment cell movement might be used to produce more snake patterns.

% snake on ground with some iridescence
\begin{figure}[ht]
	\centering
	\includegraphics[width=\columnwidth]{ground_1.png}
	\caption{A rendering of \textit{E. quadrivirgata} with iridescence.}
	\label{fig:SnakeRendering}
\end{figure}

\begin{table}[ht]
	\centering
	\resizebox{\columnwidth}{!}{
	\begin{tabular}{|l|l|l|l|l|l|l|l|}
	\hline
	\textbf{Model} & \textbf{Species} &\bm{$D_a$} &\bm{$D_s$} &\bm{$f$}    &\bm{$k$}   &\bm{$dt$} & \thead{\textbf{Total steps} \\ \textbf{(x1000)}}\\ \hline 
	A     &\textit{L. triangulum hondurensis} &1.000 &2.000 &0.026 &0.055 &0.030 &200                \\ \hline
	B     &\textit{E. quadrivirgata}     &0.175 &0.350 &0.078 &0.061 &0.030 &28                 \\ \hline
	C     &\textit{L. guttatus}          &0.350 &0.700 &0.022 &0.022 &0.100 &100; 70            \\ \hline
	D     &\textit{V. berus}             &0.150 &0.300 &0.109 &0.053 &0.300 &40                 \\ \hline
	E     &\textit{M. frontalis}         &1.000 &2.000 &0.034 &0.057 &0.030 &200; 23            \\ \hline
	\end{tabular}
	}
	\caption {In B and C the ventral scales have $f=0$. In D the ventral scales have $f=0$ and $k=0.08$. In the \Quotes{Total steps (x1000)} column, values separated by a semicolon denote a multi-phase model with the first and second values representing phase 1 and 2 respectively.}
	\label{tab:gsSnakeParameters}
\end{table}

\begin{table}[ht]
	\centering
	\resizebox{\columnwidth}{!}{
	\begin{tabular}{|l|l|l|l|l|l|l|l|l|l|l|l|}
	\hline
	\textbf{Model} & \textbf{Species} & \bm{$D_u$} &\bm{$D_v$} &\bm{$\kappa$} &\bm{$p_u$} &\bm{$p_v$} &$\bm{s_u$} &\bm{$s_v$} &\bm{$u_u$} &\bm{$dt$} &\thead{\textbf{Total steps} \\ \textbf{(x1000)}}\\ \hline 
	F     &\textit{L. californiae} &0.056 &3.36 &0.5 &0.18 &0.36 &0.001 &0.1 &0.08 &0.01 &70                \\ \hline
	\end{tabular}
	}
	\caption {Parameter values for the California kingsnake model.}
	\label{tab:snakeParameters}
\end{table}