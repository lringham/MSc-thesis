\chapter{Introduction}
From the stripes on a zebra to the spots on a leopard, nature provides a wide variety of beautiful patterns (Fig. \ref{fig:naturalPatterns1}). In 1952 Alan Turing proposed a system of partial differential equations (PDEs) aimed at explaining the formation of patterns varying spatially and temporally in terms of chemicals diffusing and reacting together through a spatial medium \citep{turing1952}. Named reaction-diffusion, this idea has since become widely used in mathematical and computational modelling of natural pattern formation. In 1972 Hans Meinhardt and Alfred Gierer independently discovered and advanced reaction-diffusion by focusing on the roles of long-range activation and short-range inhibition \citep{gierer1972}. Since then, advanced reaction-diffusion models have been created and used to explain many different biological patterns \citep{garzon2011, fowler1992, lefevre2010, meinhardt2009}.

\begin{figure}[H]
  \centering
  \includegraphics[width=\columnwidth]{fig1}
  \caption{Examples of beautiful patterns found in nature. \textit{Photographs: pixabay.com}}
  \label{fig:naturalPatterns1}
\end{figure}

There has been a large body of work with the goal of simulating reaction-diffusion patterns. These simulations can be used to give insights into the inner workings of nature or provide textures for use in computer graphics. Most simulations use regular grids to represent the space in which the partial differential equations are computed. Each grid cell represents a discrete area where chemicals are located. This arrangement offers many advantages such as ease of evaluation and the use of specialized graphics hardware to accelerate computation.

\citet{witkin1991} used reaction-diffusion as a method of texture synthesis for computer graphics. They extended the range of possible patterns from traditional reaction-diffusion by introducing anisotropic diffusion and heterogeneous diffusion rates in their simulations. The patterns were simulated on a grid, which was subsequently mapped as a texture onto geometry represented by a parametric surface. Grid boundaries were connected in the topology of a torus to avoid seams in the texture.

Growth of the spatial medium supporting pattern formation can affect the pattern's appearance. Incidentally, this is an observation that Turing identified but purposely ignored. Non-oriented lines create a pattern with a labyrinth appearance. If the domain is growing, the lines of the labyrinth orient parallel to the growth direction. Although grid domains can support global growth, an inherent problem is simulating local growth. 

% not done editing this
\citet{fowler1992} modelled patterns found on seashells using reaction-diffusion. The patterns are simulated on a polygonal mesh in a series of layers. The first layer represents the initial conditions of the pattern and each subsequent layer is a progression through time of the simulation. This approach is flexible and allows for modelling arbitrary domain growth. But it does not allow for traditional 2D pattern formation, as once a layer is simulated it is frozen in time.

\citet{turk1991} simulated reaction-diffusion on meshes by using a second Voronoi mesh to represent the original mesh surface. This Voronoi mesh was used as the spatial domain and chemicals were stored in its faces. Diffusion rates between faces were mediated by the lengths of shared edges. Using a second mesh avoids modification of the original mesh and allows for generation of detailed pattern textures. Also, there is no need to correct for pattern distortion that occurs when mapping a grid to a surface. Unfortunately, there is no consideration for growth or interaction. % Finer details in the texture are captured by the second mesh containing small faces, smaller than the original mesh

Reaction-diffusion has also been solved directly on triangular meshes \citep{descombes2016}, avoiding the need of a proxy mesh. This work leveraged the GPU allowing for much faster simulation progression compared to CPU-based computation. This speed facilitates parameter space exploration and pattern creation. 

In this thesis, I present an environment named \ProgramName{} that allows for convenient simulation and exploration of reaction-diffusion patterns, including those formed on grids and arbitrary triangular meshes. These meshes have support for growth, anisotropic diffusion, and parameters that can change value in space and over time. Reaction-diffusion is computed directly on triangular meshes by combining the use of the CPU and GPU. The CPU is used for adaptive subdivision and user interaction and the results are synchronized with the GPU. Such algorithms do not benefit from parallelism due to their recursive or sequential nature. This hybrid approach makes it possible to create fast and interactive simulations and I apply this environment to explore several cases of patterns that occur in nature.

The thesis is laid out as follows: I review the principles of reaction-diffusion patterning. Then I explain the computational aspects of simulating reaction-diffusion. Next, I describe the implementation details of the \ProgramName{} system. With that basis formalized I present four case studies. The first study models ladybug pigmentation patterns which occur on the ladybug shell. \citep{liaw2001} simulated ladybug patterns on a grid and mapped them on a sphere. This is used as the basis for my simulations performed on a triangular mesh. The second study produces reaction-diffusion patterns that look like those found on snakes. Anisotropy is used to align these patterns with respect to the snake mesh and growth is used to create more advanced patterns like rows of dual spots. The next study produces visually similar pigmentation patterns on flower petal meshes using heterogeneous parameters and anisotropic diffusion. One of the most striking aspects of real flower petals are their pigmentation patterns, an area which remains largely unexplored despite the large amount of work put into modelling other aspects of flower petals \citep{owens2016}. Next, I present a case study on modelling the autoimmune disease psoriasis based on contemporary research into cytokine interactions. This has the potential to be a powerful representation of psoriasis as it provides a mathematical representation of the disease and a fast, non-invasive way to test the disease's response to treatments. It is hoped this model can be extended to other similar autoimmune diseases. Last, I conclude the main contributes of this work and discuss future work.