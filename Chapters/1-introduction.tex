\chapter{Introduction}
From the stripes on a zebra to the spots on a leopard, nature provides a wide variety of beautiful patterns (Fig. \ref{fig:naturalPatterns1}). In 1952 Alan Turing proposed a system of partial differential equations (PDEs) aimed at explaining the formation of natural patterns. The patterns are created from chemicals that diffuse and react together through a spatial medium \citep{turing1952}. The chemicals are thought to cause various phenomena such as specialization of tissue in a process known as morphogenesis. Therefore, these chemicals are referred to as morphogens.\footnote{The term \Quotes{morphogen} should not be confused with Wolpert's positional signals definition \citep{wolpert1996}.} This system is named reaction-diffusion and has since become widely used in mathematical and computational modelling of natural pattern formation. In 1972 Hans Meinhardt and Alfred Gierer independently discovered and advanced reaction-diffusion by focusing on the roles of long-range activation and short-range inhibition \citep{gierer1972}. Since then, advanced reaction-diffusion models have been created and used to explain many different biological patterns \citep{garzon2011, fowler1992, lefevre2010, meinhardt2009}.

\begin{figure}[H]
  \centering
  \includegraphics[width=0.7\columnwidth]{fig1}
  \caption[Examples of beautiful patterns found in nature]{Examples of beautiful patterns found in nature. \CCMsg{Photographs by}{pixabay.com}{Pixabay License}.}
  \label{fig:naturalPatterns1}
\end{figure}

%\setcounter{footnote}{2}
%\footnotetext{\url{https://pixabay.com/images/id-1443973}, Retrieved, October 1, 2019} \stepcounter{footnote}
%\footnotetext{\url{https://pixabay.com/images/id-19621}, Retrieved, October 1, 2019} \stepcounter{footnote}
%\footnotetext{\url{https://pixabay.com/images/id-1480102}, Retrieved, October 1, 2019} \stepcounter{footnote}
%\footnotetext{\url{https://pixabay.com/images/id-4638920}, Retrieved, October 1, 2019} \stepcounter{footnote}
%\footnotetext{\url{https://pixabay.com/images/id-579682}, Retrieved, October 1, 2019} \stepcounter{footnote}
%\footnotetext{\url{https://pixabay.com/images/id-2717940}, Retrieved, October 1, 2019} \stepcounter{footnote}
%\footnotetext{\url{https://pixabay.com/images/id-4595254}, Retrieved, October 1, 2019} \stepcounter{footnote}
%\footnotetext{\url{https://pixabay.com/images/id-1471010}, Retrieved, October 1, 2019} \stepcounter{footnote}
%\footnotetext{\url{https://pixabay.com/images/id-2609206}, Retrieved, October 1, 2019} \stepcounter{footnote}

%https://pixabay.com/photos/thimble-common-foxglove-1443973/
%https://pixabay.com/photos/cheetah-leopard-animal-big-19621/
%https://pixabay.com/photos/ladybug-beetle-coccinellidae-insect-1480102/
%https://pixabay.com/photos/zebra-africa-wildlife-animal-4638920/
%https://pixabay.com/photos/snake-corn-snake-reptile-scale-579682/
%https://pixabay.com/photos/blossom-bloom-surfinien-close-up-2717940/
%https://pixabay.com/photos/orchid-blossom-bloom-tropical-4595254/
%https://pixabay.com/photos/giraffe-reticulated-giraffe-neck-1471010/
%https://pixabay.com/photos/tropical-aquarium-fish-water-2609206/

There has been a large body of work focused on simulating reaction-diffusion patterns. These simulations can be used to give insights into the inner workings of nature or provide textures for use in computer graphics. Regular grids represent the space in which most simulations compute the partial differential equations. Chemicals are found in the grid cells, which represent discrete areas. This arrangement offers many advantages, such as ease of evaluation and the use of specialized graphics hardware to accelerate computation.

\citet{witkin1991} used reaction-diffusion as a method of texture synthesis for computer graphics and extended the range of possible patterns from traditional reaction-diffusion by introducing anisotropic diffusion and varying diffusion rates in their simulations. The patterns were simulated on a grid, which was subsequently mapped onto a parametric surface as a texture. Grid boundaries were connected in the topology of a torus to avoid seams in the texture.

Growth of the spatial medium supporting pattern formation can affect the pattern's appearance\footnote{This is an observation that Turing identified but purposely ignored.}. Although grid domains can grow, they are not suitable for growth occurring just at a single location. Local growth requires an arbitrary surface not constrained to a rectangular shape.

\citet{lefevre2010} modelled the growth and folding of a brain using reaction-diffusion. In this work, they simulated a labyrinth pattern on a spherical mesh representing the brain's surface. Chemical concentrations determined the rate of mesh growth. This growth, in turn, provides more space for the pattern to develop. The result is labyrinth-like folds protruding from the surface of the mesh. \citet{harrison2002, holloway2007} modelled the growth of plants by coupling reaction-diffusion and surface deformation in the same way. \citet{fowler1992} modelled patterns found on seashells using a special case of growth. The shell domain starts as a 1D layer representing the initial conditions of the pattern. Layers are accrued over time, where each subsequent layer is a progression through time of the simulation.

\citet{turk1991} simulated reaction-diffusion on meshes by using a second Voronoi mesh to represent the original mesh surface. This Voronoi mesh was used as the spatial domain and chemicals were stored in its faces. The rate of diffusion across face edges depends on the edge lengths. Using a second mesh avoids modification of the original mesh and allows for the generation of detailed pattern textures. Another benefit of simulating directly on a mesh is that there is no need to correct for pattern distortion that occurs when mapping a grid to an arbitrary surface. Unfortunately, there is no consideration for growth or interaction. % Finer details in the texture are captured by the second mesh containing small faces, smaller than the original mesh

Reaction-diffusion has also been solved directly on triangular meshes \citep{descombes2016}, avoiding the need for a Voronoi mesh. This work leveraged the GPU, allowing for much faster simulation progression compared to CPU-based computation. This speed facilitated parameter space exploration and pattern creation. However, \citet{descombes2016} do not consider growth or anisotropic diffusion.

There have been a number of software applications designed around creating models that can procedurally generate patterns. A program named \Quotes{TexRD} supports simulation of reaction-diffusion on grid based domains \citep{texrd2019}. \Quotes{NetLogo} is a mature and well tested application that allows for fast simulation of PDEs and other pattern forming systems such as cellular automata \citep{netlogo1999}. A cross-platform application named \Quotes{READY} is designed around simulating GPU accelerated reaction-diffusion equations on arbitrary domains \citep{ready2012}. In the listed applications, there is no built-in support for extensions to reaction-diffusion such as anisotropic diffusion on arbitrary triangulated surfaces. Also, parameter specification is only done through editing text files.

In this thesis I present \Quotes{Lightweight Reaction-Diffusion Simulator} (\ProgramName{}), a program that facilitates simulation and exploration of reaction-diffusion patterns, including those formed on grids and arbitrary triangular meshes. These meshes have support for growth, anisotropic diffusion, and parameters that change value in over space and time. Reaction-diffusion is computed directly on triangular meshes by combining the use of the CPU and GPU. Adaptive subdivision and user interaction, which do not benefit from parallelism due to their recursive or sequential nature, use the CPU. Parallelizable algorithms, such as reaction-diffusion equations are calculated efficiently by using the GPU. This mixed approach makes it possible to create fast and interactive simulations. 

This thesis is organized as follows. First, I review the principles of reaction-diffusion patterning, and I explain the computational aspects of simulating reaction-diffusion. Next, I describe the implementation details of the \ProgramName{} system. On this basis, I present four case studies. The first study analyses ladybug shell patterns. \citet{liaw2001} produced simulations of ladybug shell patterns on a grid located on a partial sphere. I improve on this study by using arbitrary triangular meshes to replace the partial sphere. These meshes allow for an organic shell shape. I also explore some alternative parameters and initial conditions to improve on the pattern stability and appearance. The second study produces reaction-diffusion patterns that resemble those found on snakes. Anisotropy is used to align these patterns to the snake mesh and growth is used to create more complicated patterns such as rows of dual spots. The third study explores pigmentation patterns on flowers. I produced models of various flower species on meshes by using varying parameters and anisotropic diffusion. Some flowers considered include foxglove, monkeyflower, and orchids, which display vibrant patterns on attractive curved petals. Although petal pigmentation patterns are visually striking, it is an area that remains largely unexplored despite the large amount of work put into modelling other aspects of flower petals \citep{owens2016}. Next, I present a case study on modelling the autoimmune disease psoriasis based on contemporary research into cytokine interactions. A computational model of psoriasis has the potential to be a useful tool as it provides a mathematical representation of the disease and a fast, non-invasive way to test the disease's response to treatments. It is hoped this model can be extended to other autoimmune diseases as well as increasing the efficacy of treatments. Finally, I conclude the main contributes of this thesis and discuss future work.